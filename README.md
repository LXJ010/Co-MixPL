# **Co-MixPL**

This repository is an official implementation of the paper [Co-MixPL: An Optimized Semi-Supervised Learning Method for Tunnel Water Leakage Detection](https://doi.org/10.1016/j.aei.2025.104263).

Authors: Xujie Long, Jing Teng, Zhiwei Zhu, Shaobo Zhao, Mengyang Pu, Ruifeng Shi, You Lv, Jonathan Li, Guoqing Jing.



## **Installation**

We use the same environment as DINO. For detailed installation instructions, please refer to https://github.com/search?tab=readme-ov-file#installation. In addition, our implementation of the auxiliary head Faster R-CNN is adapted from `torchvision (0.15.2)`, so the version of torchvision in the environment should be **no lower than 0.15.2**.



## **Dataset**

Our code uses the `COCO 2017` dataset format as shown below:

```
COCODIR/

 ├── train2017/

 ├── val2017/

 ├── semi/

 └── annotations/

   ├── empty_coco_for_semi.json

   ├── instances_train2017.json

   └── instances_val2017.json
```


The **semi** folder contains unlabeled images used for semi-supervised learning. The file `annotations/empty_coco_for_semi.json` is automatically generated by the code based on the images in the **semi** folder.



## **Run**

#### 1. Training

The command for training using the pre-trained model [checkpoint0033_4scale.pth](https://drive.google.com/file/d/1AwUn5EebmmLBo7njjW_Ng1q9zDrqkNbB/view?usp=drive_link) is:

```sh
python main.py --output_dir logs/output -c config/DINO/DINO_4scale.py --coco_path COCODIR --options dn_scalar=100 embed_init_tgt=TRUE dn_label_coef=1.0 dn_bbox_coef=1.0 use_ema=False dn_box_noise_scale=1.0 --pretrain_model_path checkpoint0033_4scale.pth --finetune_ignore label_enc.weight class_embed
```
> Replace COCODIR with the path to your COCO dataset.

#### 2. Evaluation

To evaluate the trained model, use the following command:

```sh
python main.py --output_dir logs/output -c config/DINO/DINO_4scale.py --coco_path COCODIR --eval --options dn_scalar=100 embed_init_tgt=TRUE dn_label_coef=1.0 dn_bbox_coef=1.0 use_ema=False dn_box_noise_scale=1.0
```



## **License**

This project is released under the [Apache 2.0 license](https://github.com/LXJ010/Co-MixPL/blob/main/LICENSE).



## Citing Co-MixPL

If you find Co-MixPL useful in your research, please consider citing:

```bibtex
@article{long2026co,
  title={Co-MixPL: An optimized semi-supervised learning method for tunnel water leakage detection},
  author={Long, Xujie and Teng, Jing and Zhu, Zhiwei and Zhao, Shaobo and Pu, Mengyang and Shi, Ruifeng and Lv, You and Li, Jonathan and Jing, Guoqing},
  journal={Advanced Engineering Informatics},
  volume={71},
  pages={104263},
  year={2026},
  publisher={Elsevier}
}
```
